
o100_v1 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v1.mat');
o100_v2 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v2.mat');
o100_v3 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v3.mat');
o100_v4 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v4.mat');
o100_v5 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v5.mat');
o100_v6 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v6.mat');
o100_v7 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v7.mat');
o100_v8 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v8.mat');
o100_v9 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100_v9.mat');
o100_v10 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_100.mat');

o500_v1 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v1.mat');
o500_v2 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v2.mat');
o500_v3 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v3.mat');
o500_v4 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v4.mat');
o500_v5 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v5.mat');
o500_v6 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v6.mat');
o500_v7 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v7.mat');
o500_v8 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v8.mat');
o500_v9 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500_v9.mat');
o500_v10 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_500.mat');

o1000_v1 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v1.mat');
o1000_v2 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v2.mat');
o1000_v3 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v3.mat');
o1000_v4 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v4.mat');
o1000_v5 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v5.mat');
o1000_v6 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v6.mat');
o1000_v7 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v7.mat');
o1000_v8 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v8.mat');
o1000_v9 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000_v9.mat');
o1000_v10 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1000.mat');

o1500_v1 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v1.mat');
o1500_v2 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v2.mat');
o1500_v3 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v3.mat');
o1500_v4 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v4.mat');
o1500_v5 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v5.mat');
o1500_v6 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v6.mat');
o1500_v7 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v7.mat');
o1500_v8 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v8.mat');
o1500_v9 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500_v9.mat');
o1500_v10 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_1500.mat');

o2000_v1 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v1.mat');
o2000_v2 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v2.mat');
o2000_v3 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v3.mat');
o2000_v4 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v4.mat');
o2000_v5 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v5.mat');
o2000_v6 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v6.mat');
o2000_v7 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v7.mat');
o2000_v8 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v8.mat');
o2000_v9 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000_v9.mat');
o2000_v10 = load('output6_ma_003_plin_09/output6_ma_003_plin_09_la_2000.mat');

total_time = 1440;
delta_t_cell = 6;

time = [1:total_time]*delta_t_cell/60/24;

col1 = [50,136,189]/255;
col2 = [153,213,148]/255; 
col3 = [254,224,139]/255;
col4 =  [252,141,89]/255;
col5 = [213,62,79]/255;

o100.deadcells = [o100_v1.deadcells;o100_v2.deadcells;o100_v3.deadcells;...
    o100_v4.deadcells;o100_v5.deadcells;o100_v6.deadcells;...
    o100_v7.deadcells;o100_v8.deadcells;o100_v9.deadcells;o100_v10.deadcells]

o500.deadcells = [o500_v1.deadcells;o500_v2.deadcells;o500_v3.deadcells;...
    o500_v4.deadcells;o500_v5.deadcells;o500_v6.deadcells;...
    o500_v7.deadcells;o500_v8.deadcells;o500_v9.deadcells;o500_v10.deadcells]

o1000.deadcells = [o1000_v1.deadcells;o1000_v2.deadcells;o1000_v3.deadcells;...
    o1000_v4.deadcells;o1000_v5.deadcells;o1000_v6.deadcells;...
    o1000_v7.deadcells;o1000_v8.deadcells;o1000_v9.deadcells;o1000_v10.deadcells]

o1500.deadcells = [o1500_v1.deadcells;o1500_v2.deadcells;o1500_v3.deadcells;...
    o1500_v4.deadcells;o1500_v5.deadcells;o1500_v6.deadcells;...
    o1500_v7.deadcells;o1500_v8.deadcells;o1500_v9.deadcells;o1500_v10.deadcells]

o2000.deadcells = [o2000_v1.deadcells;o2000_v2.deadcells;o2000_v3.deadcells;...
    o2000_v4.deadcells;o2000_v5.deadcells;o2000_v6.deadcells;...
    o2000_v7.deadcells;o2000_v8.deadcells;o2000_v9.deadcells;o2000_v10.deadcells]

%mac_C1
o100.mac_C1 = [o100_v1.mac_C1;o100_v2.mac_C1;o100_v3.mac_C1;...
    o100_v4.mac_C1;o100_v5.mac_C1;o100_v6.mac_C1;...
    o100_v7.mac_C1;o100_v8.mac_C1;o100_v9.mac_C1;o100_v10.mac_C1]

o500.mac_C1 = [o500_v1.mac_C1;o500_v2.mac_C1;o500_v3.mac_C1;...
    o500_v4.mac_C1;o500_v5.mac_C1;o500_v6.mac_C1;...
    o500_v7.mac_C1;o500_v8.mac_C1;o500_v9.mac_C1;o500_v10.mac_C1]

o1000.mac_C1 = [o1000_v1.mac_C1;o1000_v2.mac_C1;o1000_v3.mac_C1;...
    o1000_v4.mac_C1;o1000_v5.mac_C1;o1000_v6.mac_C1;...
    o1000_v7.mac_C1;o1000_v8.mac_C1;o1000_v9.mac_C1;o1000_v10.mac_C1]

o1500.mac_C1 = [o1500_v1.mac_C1;o1500_v2.mac_C1;o1500_v3.mac_C1;...
    o1500_v4.mac_C1;o1500_v5.mac_C1;o1500_v6.mac_C1;...
    o1500_v7.mac_C1;o1500_v8.mac_C1;o1500_v9.mac_C1;o1500_v10.mac_C1]

o2000.mac_C1 = [o2000_v1.mac_C1;o2000_v2.mac_C1;o2000_v3.mac_C1;...
    o2000_v4.mac_C1;o2000_v5.mac_C1;o2000_v6.mac_C1;...
    o2000_v7.mac_C1;o2000_v8.mac_C1;o2000_v9.mac_C1;o2000_v10.mac_C1]

%mac_C2
o100.mac_C2 = [o100_v1.mac_C2;o100_v2.mac_C2;o100_v3.mac_C2;...
    o100_v4.mac_C2;o100_v5.mac_C2;o100_v6.mac_C2;...
    o100_v7.mac_C2;o100_v8.mac_C2;o100_v9.mac_C2;o100_v10.mac_C2]

o500.mac_C2 = [o500_v1.mac_C2;o500_v2.mac_C2;o500_v3.mac_C2;...
    o500_v4.mac_C2;o500_v5.mac_C2;o500_v6.mac_C2;...
    o500_v7.mac_C2;o500_v8.mac_C2;o500_v9.mac_C2;o500_v10.mac_C2]

o1000.mac_C2 = [o1000_v1.mac_C2;o1000_v2.mac_C2;o1000_v3.mac_C2;...
    o1000_v4.mac_C2;o1000_v5.mac_C2;o1000_v6.mac_C2;...
    o1000_v7.mac_C2;o1000_v8.mac_C2;o1000_v9.mac_C2;o1000_v10.mac_C2]

o1500.mac_C2 = [o1500_v1.mac_C2;o1500_v2.mac_C2;o1500_v3.mac_C2;...
    o1500_v4.mac_C2;o1500_v5.mac_C2;o1500_v6.mac_C2;...
    o1500_v7.mac_C2;o1500_v8.mac_C2;o1500_v9.mac_C2;o1500_v10.mac_C2]

o2000.mac_C2 = [o2000_v1.mac_C2;o2000_v2.mac_C2;o2000_v3.mac_C2;...
    o2000_v4.mac_C2;o2000_v5.mac_C2;o2000_v6.mac_C2;...
    o2000_v7.mac_C2;o2000_v8.mac_C2;o2000_v9.mac_C2;o2000_v10.mac_C2]

%figures

figure
hold on 
plot(time, o100.deadcells,'LineWidth',2,'Color',col1)
plot(time, o500.deadcells,'LineWidth',2,'Color',col2)
plot(time, o1000.deadcells,'LineWidth',2,'Color',col3)
plot(time, o1500.deadcells,'LineWidth',2,'Color',col4)
plot(time, o2000.deadcells,'LineWidth',2,'Color',col5)
xlabel('Time (days)')
ylabel('Dead cells')
set(gca,'FontSize',20)
legend('L_a = 100','L_a = 500','L_a = 1000','L_a = 1500','L_a = 2000')

figure
hold on 
plot(time, o100.deadcells./(o100.mac_C1+o100.mac_C2),'LineWidth',2,'Color',col1)
plot(time, o500.deadcells./(o500.mac_C1+o500.mac_C2),'LineWidth',2,'Color',col2)
plot(time, o1000.deadcells./(o1000.mac_C1+o1000.mac_C2),'LineWidth',2,'Color',col3)
plot(time, o1500.deadcells./(o1500.mac_C1+o1500.mac_C2),'LineWidth',2,'Color',col4)
plot(time, o2000.deadcells./(o2000.mac_C1+o2000.mac_C2),'LineWidth',2,'Color',col5)
xlabel('Time (days)')
ylabel('Ratio dead cells/macrophages')
legend('L_a = 100','L_a = 500','L_a = 1000','L_a = 1500','L_a = 2000')
set(gca,'FontSize',20)

figure
hold on 
plot(time, (o100.mac_C1+o100.mac_C2),'LineWidth',2,'Color',col1)
plot(time, (o500.mac_C1+o500.mac_C2),'LineWidth',2,'Color',col2)
plot(time, (o1000.mac_C1+o1000.mac_C2),'LineWidth',2,'Color',col3)
plot(time, (o1500.mac_C1+o1500.mac_C2),'LineWidth',2,'Color',col4)
plot(time, (o2000.mac_C1+o2000.mac_C2),'LineWidth',2,'Color',col5)
xlabel('Time (days)')
ylabel('Total macrophages')
legend('L_a = 100','L_a = 500','L_a = 1000','L_a = 1500','L_a = 2000')
set(gca,'FontSize',20)


fig1 = figure 
hold on 
options.handle = fig1;
options.alpha = 0.8;
options.error = 'std';
options.line_width = 2;
options.x_axis = time;

options.color_area = col1;
options.color_line = options.color_area;
plot_areaerrorbar(o100.deadcells, options)
hold on 
options.color_area = col2;
options.color_line = options.color_area;
plot_areaerrorbar(o500.deadcells, options)
hold on 
options.color_area = col3;
options.color_line = options.color_area;
plot_areaerrorbar(o1000.deadcells, options)
hold on 
options.color_area = col4;
options.color_line = options.color_area;
plot_areaerrorbar(o1500.deadcells, options)
hold on 
options.color_area = col5;
options.color_line = options.color_area;
plot_areaerrorbar(o2000.deadcells, options)
hold on 

xlabel('Time (days)')
ylabel('Dead cells')
set(gca,'FontSize',18)
%ylim([0 4])
xlim([0 6])



fig1 = figure 
hold on 
options.handle = fig1;
options.alpha = 0.8;
options.error = 'std';
options.line_width = 2;
options.x_axis = time;

options.color_area = col1;
options.color_line = options.color_area;
plot_areaerrorbar((o100.mac_C1+o100.mac_C2), options)
hold on 
options.color_area = col2;
options.color_line = options.color_area;
plot_areaerrorbar((o500.mac_C1+o500.mac_C2), options)
hold on 
options.color_area = col3;
options.color_line = options.color_area;
plot_areaerrorbar((o1000.mac_C1+o1000.mac_C2), options)
hold on 
options.color_area = col4;
options.color_line = options.color_area;
plot_areaerrorbar((o1500.mac_C1+o1500.mac_C2), options)
hold on 
options.color_area = col5;
options.color_line = options.color_area;
plot_areaerrorbar((o2000.mac_C1+o2000.mac_C2), options)
hold on 

xlabel('Time (days)')
ylabel('Total macrophages')
set(gca,'FontSize',18)
%ylim([0 4])
xlim([0 6])




